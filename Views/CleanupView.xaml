<UserControl x:Class="PcPerformanceManager.Views.CleanupView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converters="clr-namespace:PcPerformanceManager.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   Text="Disk Cleanup" 
                   FontSize="28" 
                   FontWeight="Bold" 
                   Margin="0,0,0,20"
                   Foreground="#2C3E50"/>

        <!-- Controls Bar -->
        <Border Grid.Row="1" 
                Background="#ECF0F1" 
                Padding="15" 
                CornerRadius="5" 
                Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Border Margin="0,0,10,0" CornerRadius="5" Background="#3498DB">
                        <Button Content="Analyze" 
                                Command="{Binding AnalyzeCommand}"
                                IsEnabled="{Binding IsAnalyzing, Converter={StaticResource InverseBooleanConverter}}"
                                Padding="20,10"
                                Background="Transparent"
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"
                                FontSize="14"/>
                    </Border>
                    <Button Content="Select All" 
                            Command="{Binding SelectAllCommand}"
                            Padding="15,10"
                            Margin="0,0,10,0"
                            Cursor="Hand"
                            FontSize="14"/>
                    <Button Content="Deselect All" 
                            Command="{Binding DeselectAllCommand}"
                            Padding="15,10"
                            Cursor="Hand"
                            FontSize="14"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="{Binding StatusMessage}" 
                               FontSize="14" 
                               VerticalAlignment="Center"
                               Foreground="#34495E"
                               Margin="0,0,15,0"/>
                    <Border CornerRadius="5" Background="#E74C3C">
                        <Button Content="Clean Selected" 
                                Command="{Binding CleanupCommand}"
                                IsEnabled="{Binding IsCleaning, Converter={StaticResource InverseBooleanConverter}}"
                                Padding="20,10"
                                Background="Transparent"
                                Foreground="White"
                                BorderThickness="0"
                                Cursor="Hand"
                                FontSize="14"
                                FontWeight="Bold"/>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Statistics -->
        <Border Grid.Row="2" 
                Background="White" 
                BorderBrush="#BDC3C7" 
                BorderThickness="1" 
                CornerRadius="8" 
                Padding="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Summary -->
                <Border Grid.Row="0" 
                        Background="#E8F5E9" 
                        Padding="15" 
                        CornerRadius="5" 
                        Margin="0,0,0,15"
                        Visibility="{Binding SelectedItemsCount, Converter={StaticResource CountToVisibilityConverter}}">
                    <StackPanel>
                        <TextBlock FontSize="16" FontWeight="Bold" Foreground="#27AE60">
                            <Run Text="Selected: "/>
                            <Run Text="{Binding SelectedItemsCount}"/>
                            <Run Text=" items"/>
                            <Run Text=" ("/>
                            <Run Text="{Binding TotalBytesToClean, Converter={StaticResource BytesToGBConverter}, StringFormat='{}{0:F2}'}"/>
                            <Run Text=" GB)"/>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- Result Message -->
                <Border Grid.Row="1" 
                        Background="#D1ECF1" 
                        Padding="15" 
                        CornerRadius="5" 
                        Margin="0,0,0,15"
                        Visibility="{Binding LastCleanupResult, Converter={StaticResource StringToVisibilityConverter}}">
                    <TextBlock Text="{Binding LastCleanupResult}" 
                               FontSize="14" 
                               Foreground="#0C5460"
                               TextWrapping="Wrap"/>
                </Border>

                <!-- Cleanup Items List -->
                <DataGrid Grid.Row="2" 
                          ItemsSource="{Binding CleanupItems}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          GridLinesVisibility="None"
                          HeadersVisibility="Column"
                          SelectionMode="Single"
                          RowBackground="White"
                          AlternatingRowBackground="#F8F9FA">
                    <DataGrid.Columns>
                        <DataGridCheckBoxColumn Header="Select" 
                                                Binding="{Binding IsSelected}" 
                                                Width="60"/>
                        <DataGridTextColumn Header="Name" 
                                            Binding="{Binding Name}" 
                                            Width="200"
                                            ElementStyle="{StaticResource DataGridTextStyle}"/>
                        <DataGridTextColumn Header="Description" 
                                            Binding="{Binding Description}" 
                                            Width="*"
                                            ElementStyle="{StaticResource DataGridTextStyle}"/>
                        <DataGridTextColumn Header="Category" 
                                            Binding="{Binding Category}" 
                                            Width="150"
                                            ElementStyle="{StaticResource DataGridTextStyle}"/>
                        <DataGridTextColumn Header="Size" 
                                            Binding="{Binding SizeGB, StringFormat='{}{0:F2} GB'}" 
                                            Width="120"
                                            ElementStyle="{StaticResource DataGridTextStyle}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>

        <!-- Loading Indicator -->
        <Border Grid.Row="3" 
                Background="#3498DB" 
                Padding="15" 
                Margin="0,10,0,0"
                Visibility="{Binding IsAnalyzing, Converter={StaticResource BooleanToVisibilityConverter}}">
            <TextBlock Text="Analyzing files..." 
                       Foreground="White" 
                       FontSize="14"
                       HorizontalAlignment="Center"/>
        </Border>
    </Grid>
</UserControl>
